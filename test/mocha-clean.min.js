var slash,cwd,Mocha,Runner,env,is;"undefined"==typeof document?(is={node:!0},slash=require("path").sep||"/",cwd=process.cwd()+slash,Runner=(Mocha=require("mocha")).Runner,env=function(){return process.env}):(is={browser:!0},slash="/",cwd=location.href.replace(/\/[^\/]*$/,"/"),Runner=(Mocha=this.Mocha).Runner,env=function(){return{}}),is.browser&&mocha&&!mocha.traceIgnores&&(mocha.traceIgnores=["mocha.js"]);var old=Runner.prototype.fail;function __mocha_internal__cleanError(e){if(!e.stack)return e;var n=e.stack.split("\n");return n=n.reduce(function(e,n){return is.node&&(isNodeModule(n)||isMochaInternal(n)||isNodeInternal(n)||isMochaCleanInternal(n))?e:is.browser&&(isBrowserIgnored(n)||isMochaCleanInternal(n))?e:(env().SHOW_ABSOLUTE_PATHS||(n=n.replace(cwd,"")),env().FILENAMES_FIRST&&(n=reorderFilename(n)),e.push(n),e)},[]),e.stack=n.join("\n"),e}function isNodeModule(e){return~e.indexOf("node_modules")&&!env().SHOW_NODE_MODULES}function isMochaInternal(e){return~e.indexOf("node_modules"+slash+"mocha")}function isBrowserIgnored(e){for(var n=mocha.traceIgnores||[],r=0,o=n.length;r<o;r++){var a=n[r];if("string"==typeof a&&~e.indexOf(a)||"function"==typeof a&&a(e)||a instanceof RegExp&&e.match(a))return!0}}function isMochaCleanInternal(e){return~e.indexOf("__mocha_internal__")}function isNodeInternal(e){return~e.indexOf("(timers.js:")||~e.indexOf("(node.js:")||~e.indexOf("(module.js:")||~e.indexOf("GeneratorFunctionPrototype.next (native)")||!1}function reorderFilename(e){var n;return(n=e.match(/^(\s*)at (.*?) \(native\)$/))?n[1]+"[native]: "+n[2]:(n=e.match(/^(\s*)at (.*?) \((.*?)\)$/))?""+n[1]+n[3]+": "+n[2]:(n=e.match(/^(\s*)at (.*?)$/))?""+n[1]+n[2]+":":e}Runner.prototype.fail=function(e,n){return n=__mocha_internal__cleanError(n),old.call(this,e,n)},"object"==typeof module&&(exports.cleanError=__mocha_internal__cleanError,exports.reorderFilename=reorderFilename);
